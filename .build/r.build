#!/bin/bash
set -e 

mkdir -p ~/.R
echo 'CC=clang' > ~/.R/Makevars
echo 'CXX=clang++' >> ~/.R/Makevars

pwd

echo Make Library
./autogen.sh
./configure CXXFLAGS='-O0'
make -C R

echo Install Library
R CMD INSTALL ./R.Rcheck/QuantLib

echo Execute Scripts in demo folder
for fn in ./R/demo/*.R
do
echo Test $fn
Rscript "$fn"
done 

